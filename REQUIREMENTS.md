# Spring Boot JWT 认证与授权服务需求

## 概要
- 基于 Spring Boot 的 REST 服务，提供用户注册、登录与基于 JWT 的访问控制。
- 使用 Spring Security 与 JWT（含访问令牌与可选刷新令牌）保护受限端点。

## 功能需求
- 用户注册：提交用户名/邮箱 + 密码；校验唯一性与格式，密码使用安全哈希存储。
- 登录：校验凭据，签发包含用户标识与角色/权限的访问令牌；支持刷新令牌获取新访问令牌。
- 授权：对受保护接口基于角色/权限进行访问控制；未授权/未认证请求返回相应错误。
- 登出/失效（可选）：支持刷新令牌或访问令牌失效机制（如黑名单或版本号）。
- 错误处理：统一返回错误码与消息，避免泄露敏感信息。

## API 设计（示例路径）
- `POST /api/auth/register`：注册新用户。
- `POST /api/auth/login`：用户名/邮箱 + 密码登录，返回访问令牌与刷新令牌（如启用）。
- `POST /api/auth/refresh`：使用刷新令牌获取新访问令牌。
- `GET /api/users/me`：示例受保护端点，返回当前用户信息。

## 安全与实现细节
- 使用 Spring Security 过滤器链解析并验证 JWT；无效或过期令牌拒绝请求。
- 访问令牌含声明：用户 ID、用户名/邮箱、角色/权限、签发与过期时间。
- 密钥/公私钥存放于安全配置（环境变量/配置文件）；不要硬编码。
- 采用 HTTPS 部署；对跨域请求按需配置 CORS。
- 全局异常处理，隐藏内部异常细节。

## 数据模型（最小）
- 用户：主键 ID，用户名/邮箱（唯一），密码哈希，角色列表。
- Role/Authority：名称（如 ROLE_USER，ROLE_ADMIN）。

## 配置项
- JWT 签名密钥或密钥对；访问令牌与刷新令牌的有效期。
- 密码哈希算法（如 BCrypt）强度；可选令牌黑名单存储（缓存/数据库）。
